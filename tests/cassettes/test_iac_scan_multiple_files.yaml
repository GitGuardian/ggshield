interactions:
- request:
    body: !!binary |
      LS05NmU4YzFjNzFiOTE2YTkwZjQ3NzM4MThkNjY5MmUyNQ0KQ29udGVudC1EaXNwb3NpdGlvbjog
      Zm9ybS1kYXRhOyBuYW1lPSJzY2FuX3BhcmFtZXRlcnMiDQoNCnsiaWdub3JlZF9wb2xpY2llcyI6
      IFtdLCAibWluaW11bV9zZXZlcml0eSI6ICJMT1cifQ0KLS05NmU4YzFjNzFiOTE2YTkwZjQ3NzM4
      MThkNjY5MmUyNQ0KQ29udGVudC1EaXNwb3NpdGlvbjogZm9ybS1kYXRhOyBuYW1lPSJkaXJlY3Rv
      cnkiOyBmaWxlbmFtZT0iZGlyZWN0b3J5Ig0KDQofiwgA8dCdYgL/7ZfNbqMwFEZZ8xSWH8DxH5As
      Is2yyy66G1WWQ0yKajAyRkmn6ruPaSZtKtqu2kTT3MMCdG18F/BxDJmR2a9rvbsyem188i3QPR+d
      KRXy9XqsM8oZT9AuOQFDH7SP7ZPLhM9RE+rGLFmeyYwu5nRBpCjyPONpAvx4al2qqrZGMRKq5Pvy
      n8t9xuObtc86f808oyJhkstCZFTkLOZfsqxIED1l/hsdwl1thj93ut28My9Oq6qf9/xTb3o3+NIg
      rLe90nalbN0H0xqPEV7ptTI73XTWYPSYItR5F1zpLFoifHVzc43TJ/hM/M8Q8D/4f+r/OVsUEOxL
      8r84n/8Fyyb+j9PA/6f3f2vC1vl7pUur/DBaf7oHMJt4T48OLFGlbW+ONweHARzKDseByrtGdc6H
      wwDnsRrcUe2lOnaN7UPt2n+LaGvddlymrNderawr7w/rM06YIEwSlsFOBPwP/v8q/xdyLiFOl+R/
      fk7/T///cwH+P4P/e1MOvg4PauPd0H1i//Hy2Mh91PFvTMnzMaP4No4/RSWjFH3W4cNNRnjozGj4
      un3u91b/02ZjIwgzAAAAAAAAAAAAAADAO/wFwGvkIAAoAAANCi0tOTZlOGMxYzcxYjkxNmE5MGY0
      NzczODE4ZDY2OTJlMjUtLQ0K
    headers:
      Accept:
      - '*/*'
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      Content-Length:
      - '759'
      Content-Type:
      - multipart/form-data; boundary=96e8c1c71b916a90f4773818d6692e25
      GGShield-Command-Path:
      - cli iac scan
      GGShield-Version:
      - 1.11.0
      User-Agent:
      - pygitguardian/1.3.4 (Darwin;py3.10.4) ggshield
    method: POST
    uri: https://api.gitguardian.com/v1/iacscan
  response:
    body:
      string: '{"id":"","type":"path_scan","iac_engine_version":"1.1.0","entities_with_incidents":[{"filename":"iac_file_single_vulnerability.tf","incidents":[{"policy":"Plain
        HTTP is used","policy_id":"GG_IAC_0001","severity":"HIGH","component":"aws_alb_listener.bad_example","line_end":3,"line_start":3,"description":"Plain
        HTTP should not be used, it is unencrypted. HTTPS should be used instead.","documentation_url":"https://gitguardian.com","ignore_sha":"shasha"}]},{"filename":"iac_file_multiple_vulnerabilities.tf","incidents":[{"policy":"Unrestricted
        egress traffic might lead to remote code execution.","policy_id":"GG_IAC_0002","severity":"HIGH","component":"aws_security_group.bad_example","line_end":4,"line_start":4,"description":"Open
        egress means that the asset can download data from the whole web.","documentation_url":"https://gitguardian.com","ignore_sha":"shasha"},{"policy":"Unrestricted
        ingress traffic leaves assets exposed to remote attacks.","policy_id":"GG_IAC_0003","severity":"HIGH","component":"aws_security_group_rule.bad_example","line_end":10,"line_start":10,"description":"A
        security group has open ingress from all IPs, and on all ports. This means
        that the\nassets in this security group are exposed to the whole web.\n\nFurthermore,
        no port range is specified. This\nmeans that some applications running on
        assets of this security group may be reached by\nexternal traffic, while they
        are not expected to do so.","documentation_url":"https://gitguardian.com","ignore_sha":"shasha"}]}]}'
    headers:
      Access-Control-Expose-Headers:
      - X-App-Version
      Allow:
      - POST, OPTIONS
      Connection:
      - keep-alive
      Content-Type:
      - application/json
      Date:
      - Mon, 06 Jun 2022 10:03:31 GMT
      Referrer-Policy:
      - strict-origin-when-cross-origin
      Strict-Transport-Security:
      - max-age=15724800; includeSubDomains
      Transfer-Encoding:
      - chunked
      Vary:
      - Accept-Encoding
      - Cookie
      X-App-Version:
      - 3751cc90
      X-Content-Type-Options:
      - nosniff
      - nosniff
      X-Frame-Options:
      - DENY
      - SAMEORIGIN
      X-Secrets-Engine-Version:
      - 2.68.0
      X-XSS-Protection:
      - 1; mode=block
      content-length:
      - '1499'
    status:
      code: 200
      message: OK
version: 1
